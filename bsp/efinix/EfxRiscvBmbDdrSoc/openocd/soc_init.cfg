set cpu_count $::env(SAXON_CPU_COUNT)

for {set i 0} {$i < $cpu_count} {incr i} {
    target create saxon.cpu$i vexriscv -endian little -chain-position $TAP_NAME -coreid $i -dbgbase [expr $i*0x1000+0x10B80000] -work-area-phys 0xF9000000 -work-area-size 1024
    vexriscv readWaitCycles 40
    vexriscv cpuConfigFile $CPU0_YAML
    vexriscv jtagMapping 8 8 0 1 2 2
}

flash bank xip vexriscv_nor_spi 0x00000000 0x1000000 0 0 saxon.cpu0 0xF8014000

for {set i 0} {$i < $cpu_count} {incr i} {
    targets saxon.cpu$i
    poll_period 50
    init
    soft_reset_halt
}




targets saxon.cpu0
if {$SPINAL_SIM != "yes"} {
    load_image software/standalone/sdramInit/build/sdramInit.bin 0xF9000000
    puts -nonewline "init SDRAM .."
    resume 0xF9000000
    wait_halt
    puts " done"
}

